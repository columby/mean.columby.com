<div class="dataset view" ng-cloak>

  <div class="actions-bar"
    scroll-position="scroll"

    ng-class="{top: scroll<315}">
    <ul>
      <li>
        <button class="btn btn-default edit"
          type     = "button"
          ng-hide  = "editMode"
          ng-show  = "dataset.canEdit"
          ng-click = "toggleEditmode()">Edit
        </button>
      </li>

      <li>
        <button
          class    = "btn dbt-default options"
          ng-show  = "editMode && dataset._id"
          ng-class = "{active: showOptions}"
          ng-click = "toggleOptions()">Options
        </button>
      </li>

      <li>
        <button class="btn btn-default edit"
          type     = "button"
          ng-show  = "editMode && dataset._id"
          ng-click = "toggleEditmode()">View dataset
        </button>
      </li>
    </ul>
  </div>

  <!-- Editor Sidebar -->
  <div class="editorSidebar" ng-show="editMode && showOptions">
    <div class="options-arrow"></div>
    <div class="editorSidebarContent">
      <div class="sidebarModule">
	      <div class="visibility setting" ng-show="dataset._id">
          <h3>Visibility
            <button
              class="right btn-xs btn-tooltip"
              popover="Change visibility settings for your dataset."
              popover-trigger="mouseenter"
              popover-placement="left"
              class="btn btn-default"><i class="fa fa-question"></i></button>
          </h3>
	        <div class="btn-group btn-toggle">
          	<button
              ng-click="togglePrivate('true')"
              class="btn btn-xs btn-default btn-private"
              ng-class="{active: dataset.private === true}"
              ng-disabled="dataset.private === true">Private</button>
          	<button
              ng-click="togglePrivate('false')"
              class="btn btn-xs btn-default btn-public"
              ng-class="{active: dataset.private === false}"
              ng-disabled="dataset.private === false">Public</button>
          	</div>
	      </div>
			</div>

      <div class="slug" ng-show="dataset._id">
        <h3>Custom URL
          <button
            class="right btn-xs btn-tooltip"
            popover="Create a custom URL for this dataset that is more memorable than a random string of characters. Many people create a URL that matches the dataset title."
            popover-trigger="mouseenter"
            popover-placement="left"
            class="btn btn-default"><i class="fa fa-question"></i>
          </button>
        </h3>
				<span>{{hostname}}/d/{{dataset.slug | slugify}}</span>


        <form class="form-horizontal novalidate" role="form" name="slugForm">
          <div class="form-group">
            <input class="form-control input-slug"
              name="slug"
              ng-model="dataset.slug"
              ng-minlength="3"
              ng-maxlength="30"/>
            <span class="error" ng-show="slugForm.slug.$error.maxlength">Too long!</span>
            <span class="error" ng-show="slugForm.slug.$error.minlength">Too short!</span>
            <button
              class="btn btn-xs btn-default"
              ng-click="updateSlug()"
              placeholder="dataset-name"
              ng-show="slugForm.$valid">update url</button>
          </div>
        </form>
      </div>

      <div class="header-background">
        <h3>Custom header background</h3>
        <div class="btn"
          ng-file-select="updateHeaderImage($files)"
          data-multiple="false"><i class="fa fa-cog"></i>
        </div>
      </div>
    </div>
  </div>

  <!-- Main dataset Content -->
  <div class="content" ng-class="{show:!contentLoading}">

    <div class="header wrapper" ng-style="headerStyle">
      <div class="container">
  			<div class="col-md-12">

          <!-- Editable title -->
          <div ng-switch="editMode">
            <h1 class="title" ng-switch-default ng-bind-html="dataset.title || 'No title yet'"></h1>

            <textarea ng-switch-when="true"
              class       = "title edit"
              auto-grow
              type        = "text"
              name        = "title"
              placeholder = "Your title"
              ng-model    = "datasetUpdate.title"
              ng-blur     = "updateTitle()"
              focus       = "true"
              ></textarea>
            <!-- <h2 class="page-subtitle">dataset</h2> -->
          </div>
          <!-- Meta -->
          <div class="meta" ng-show="dataset._id">
						<span ng-show="dataset.private === true" class="label bg-primary">private</span>
            <p>A dataset by
              <span class="account"><a ui-sref="account.view({slug:dataset.account.slug})">{{dataset.account.name || 'noname'}}</a>,
              <span class="published">created on <time class="post-date">{{dataset.createdAt | date:'d MMMM yyyy'}}</time></span>
            </p>
            <p ng-show="dataset.tags.length>0"><strong>Tags: </strong><span ng-repeat="tag in dataset.tags">{{tag}}</span></p>
          </div>

          <!-- Editable avatar -->
          <div class="avatar" ng-switch="editMode">
            <a ng-switch-default ui-sref="account.view({slug:dataset.account.slug})">
              <img src="{{dataset.account.avatar.url}}" alt="{{dataset.account.name}}"/>
            </a>
            <a ng-switch-when="true" ui-sref="account.view({slug:dataset.account.slug})">
              <img src="{{$root.user.accounts[ $root.selectedAccount].avatar.url}}" alt="new"/>
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Dataset Description -->
    <div class="description wrapper">
      <!-- Editable description -->
      <div class="container">
        <div class="col-md-12" ng-switch="editMode">
          <h3 ng-show="editMode">Description
            <button
              class="right btn-xs btn-tooltip"
              popover="Add a nice description about your dataset."
              popover-trigger="mouseenter"
              popover-placement="left"
              class="btn btn-default"><i class="fa fa-question"></i>
            </button>
          </h3>

          <div
            ng-switch-default
            ng-bind-html="dataset.description || '<p>The publisher of this dataset has not yet provided a description yet.</p>'" class="data-description">
          </div>
          <div
            ng-switch-when = "true">
            <div
              ng-model        = "datasetUpdate.description"
              text-angular
              ta-default-wrap = "p"
              ng-blur         = "updateDescription()"
              ta-toolbar      = "[['quote','bold','italics','underline'],['ul','ol','indent','outdent'],['insertLink','insertVideo']]"
          ></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Dataset Info -->
    <div class="info wrapper" ng-hide="true">
      <div class="container">
        <div class="col-md-12">
        <!-- <div class="content" ng-bind-html="summary"></div> -->
          <div class="content"><p>Dit is een voorbeeld van een data licentie regel die automatisch gegenereerd zal worden. Deze dataset heeft <span class="highlight">Licentie X.3.0</span>. De dataset bevat <span class="highlight">3</span> data distributions met in totaal <span class="highlight">351</span> rijen. Er zijn <span class="highlight">2</span> referenties.</p>
            <h3>Columby score<button class="right btn-xs btn-tooltip" popover="The Columby Score meter gauges how specified your publication is. The strength will increase as you fill in the details and add more content." popover-trigger="mouseenter" popover-placement="left" class="btn btn-default">?</button></h3><progressbar class="progress-striped active" max="100" value="55"><i>55%</i></progressbar>
          </div>
        </div>
      </div>
    </div>

    <!-- Dataset Sources -->
    <div class="distributions wrapper" ng-hide="!dataset._id">
      <div class="container">
        <div class="col-md-12">

          <h3>Sources
            <button
              class="right btn-xs btn-tooltip"
              popover="Add some datasources to your dataset. These can be links to webpages and files. But you can also upload your data (xls, csv, etc.) to Columby."
              popover-trigger="mouseenter"
              popover-placement="left"
              class="btn btn-default"
              ng-show="editMode"><i class="fa fa-question"></i>
            </button>
          </h3>
          <ul ng-hide="!dataset.distributions || dataset.distributions.length===0">
            <li ng-repeat="distribution in dataset.distributions">
              <h4><a href="{{distribution.accessUrl}}" target="_blank">{{distribution.title}}</a><span class="label bg-primary">File</span></h4>
  						<div class="date-size">{{distribution.type}} - {{distribution.issued | date:'d MMMM yyyy'}} - {{distribution.size}}</div>
              
              <ul class="properties">
                <!-- <li><label>Title</label>Hier komt een titel van een dataset</li> -->
                <li><label>Datasource type</label>File</li>
                <li><label>Access URL</label><a href="{{distribution.accessUrl}}" target="_blank">access url</a></li>
                <li><label>Download URL</label><a href="{{distribution.downloadUrl}}" target="_blank">download url</a></li>
                <li><label>Media type</label>application/csv</li>
                <li><label>File size</label>20.34 MB</li>
                <br/>
                <li><label>Issued</label>20-10-2014</li>
                <li><label>Modified</label>20-10-2014</li>
                <li><label>License</label>cc0</li>
                <br/>
                <li><label>Sync</label>Every 24 hours</li>
                <li><label>Last sync</label>2 hours ago</li>
              </ul>
              
              <div class="download" ng-show="distribution.downloadUrl">
                <a href="{{distribution.downloadUrl}}"><i class="fa fa-download"></i></a>
              </div>
              <div class="link" ng-show="distribution.accessUrl">
                <a href="{{distribution.accessUrl}}"><i class="fa fa-external-link"></i></a>
              </div>

              <div class="actions" ng-show="editMode">
                <a href="" ng-click="editDistribution($index)"><i class="fa fa-edit"></i></a>
                <a href="" ng-click="deleteDistribution($index)"><i class="fa fa-trash"></i></a>
              </div>
              


              <!-- title            : Some title,<br/> show_with_placeholder -->
              <!-- description      : Some text tescription,<br/> -->
              <!-- issued           : Date,<br/> show_if_available -->
              <!-- modified         : Date,<br/> show_if_available
              license          : cc0, andere versies<br/> show_with_placeholder
              accessUrl        : { type: String },<br/> show
              of - downloadUrl : { type: String },<br/>or show
              mediaType        : application/csv of application/link<br/> icon
              byteSize         : 12345 bytes,<br/> show_if_available

              sync on? check if syncPeriod === true
              syncPeriod -->
              <!-- last sync -> syncDate -->


  					</li>
          </ul>
          <div class="highlight" ng-show="!dataset.distributions || dataset.distributions.length===0">
						<!-- <i class="fa fa-exclamation-circle"></i> -->
						<h2>No sources added yet</h2>
						<p ng-show="editMode">Upload a file to Columby directly or locate a remote file from the internet. Columby will process your data, so it will become available through the API.</p>
					</div>

          <!-- Datasource Modal -->
          <button
            ng-show="editMode"
            class="btn btn-default btn-add"
            type="button"
            ng-click="initNewDistribution()"
            >Add new data source</button>

        </div>
      </div>
    </div>

    <!-- Dataset Preview -->
    <div class="preview wrapper" ng-hide="editMode || !dataset.preview">
      <div class="content">
        <table class="table">
          <thead>
            <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
          </thead>
          <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
          <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
          <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
          <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
          <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
        </table>
      </div>
    </div>

    <!-- Dataset Use -->
    <!-- <div class="use wrapper" ng-hide="editMode">
      <div class="container">
        <div class="col-md-12">

          <div class="content">
            <h3>Use this dataset</h3>
            <p>Some text about how to use this data.</p>
          </div>

        </div>
      </div>
    </div> -->

    <!-- Dataset UUID -->
    <!-- <div class="uuid wrapper" ng-show="dataset._id && !editMode">
      <div class="container">
        <div class="col-md-12">

          <div class="content uuid">
            <h4>UUID: {{dataset._id}}</h4>
          </div>

        </div>
      </div>
    </div> -->

    <!-- Dataset references -->
    <div class="references wrapper" ng-hide="!dataset._id">
      <div class="container">
        <div class="col-md-12">

          <div class="content" ng-show="editMode || dataset.references.length>0">
            <h3>References<button
              class="right btn-xs btn-tooltip"
              popover="Did you make a nice App with this data? Have a cool blogpost about this data? Or an infographic? Paste links to these references here."
              popover-trigger="mouseenter"
              popover-placement="left"
              class="btn btn-default"
              ng-show="editMode"><i class="fa fa-question"></i>
            </button></h3>
            <ul>
              <li ng-repeat="reference in dataset.references">
  							<div class="col-md-12">
                  <h4><a href="{{reference.url}}">{{reference.title}}</a></h4>
                </div>
                <div class="col-sm-12">
                  <img src="{{reference.image}}" class="preview"/>
                  <p>{{reference.description}}</p>
  							  <p class="meta"><a href="{{reference.url}}">{{reference.provider_display}}</a></p>
                </div>
                <div class="actions" ng-show="editMode">
                  <a href="" ng-click="deleteReference($index)"><i class="fa fa-trash"></i></a>
                </div>
  						</li>
            </ul>
	          <div class="highlight" ng-show="!dataset.references || dataset.references.length===0">
							<!-- <i class="fa fa-exclamation-circle"></i> -->
							<h2>No references added yet</h2>
							<p ng-show="editMode">Did you get creative with your data? Add some references of output like a Data visualisation, app or website.</p>
						</div>

          <!-- Datasource Modal -->
          <button
            ng-show="editMode"
            class="btn btn-default btn-add"
            type="button"
            ng-click="newReference()"
            >Add new reference</button>
          </div>

        </div>
      </div>
    </div>

    <!-- Dataset Account -->
    <div class="account wrapper" ng-hide="editMode">
      <div class="container">
        <div class="col-md-12">

          <div class="content">
              <h3>About {{dataset.account.name}}</h3>
              <div ng-bind-html="dataset.account.description" class="account-description"></div>
  						<p class="more-about"><a ui-sref="account.view({slug: dataset.account.slug})">more about {{dataset.account.name}}</a></p>
            </div>
          </div>

        </div>
      </div>
    </div>

    <!-- Share Dataset -->
    <div class="share wrapper" ng-hide="editMode">
      <div class="container">
        <div class="col-md-12 content">
					<h3>Share this dataset</h3>
          <div share-square="false" share-links="Facebook, Twitter, LinkedIn, Google-Plus"></div>
        </div>
      </div>
    </div>

    <!-- Dataset Collections -->
    <div class="collections wrapper" ng-hide="dataset || dataset._id || !editMode">
      <div class="container">
        <div class="content">
          <h3>Collections</h3>
          List of collections

          <!-- Datasource Modal -->
          <button
            ng-show="editMode"
            class="btn btn-default"
            type="button"
            ng-click="addToCollection()"
            >Add to collection</button>
        </div>
      </div>
    </div>


		<!-- Create new dataset -->
		<div class="step1 wrapper" ng-hide="dataset._id">
			<div class="container">
				<div class="col-md-12">
		      <button
		        class    = "btn dbt-default create disabled"
		        ng-hide  = "dataset._id || datasetUpdate.title">Save draft & proceed to add data
		      </button>
					<p ng-hide  = "dataset._id || datasetUpdate.title">Please add a title first.</p>
		      <button
		        class    = "btn dbt-default create"
		        ng-hide  = "dataset._id || !datasetUpdate.title"
		        ng-click = "create()">Save draft & proceed to add data
		      </button>
					<p ng-hide  = "dataset._id || !datasetUpdate.title">Don't worry, you can still change your title and description.</p>
				</div>
			</div>
		</div>



  </div>
</div>

<div class="dataset view" ng-controller="DatasetViewCtrl">

  <!-- Editor Sidebar -->
  <div class="editorSidebar" ng-show="editMode">
    <div class="editorSidebarContent">
      <!-- exit existing set -->
      <button
        ng-show="dataset._id"
				class="btn dbt-default"
				ng-click="exitEditmode()">Exit edit mode</button>

      <!-- publish new dataset -->
      <button
        class="btn dbt-default create"
        ng-show="!dataset._id"
        ng-click="create()">Publish</button>


      <div class="sidebarModule">
	      <div class="visibility setting" ng-show="dataset._id">
          <h3>Visibility
            <button
              class="right btn-xs btn-tooltip"
              popover="Change visibility settings for your dataset."
              popover-trigger="mouseenter"
              popover-placement="left"
              class="btn btn-default"><i class="fa fa-question"></i></button>
          </h3>
	        <div class="btn-group btn-toggle">
          	<button
              ng-click="toggleVisibilityStatus('private')"
              class="btn btn-xs btn-default"
              ng-class="{active: dataset.visibilityStatus === 'private'}"
              ng-disabled="dataset.visibilityStatus === 'private'">Private</button>
          	<button
              ng-click="toggleVisibilityStatus('public')"
              class="btn btn-xs btn-default"
              ng-class="{active: dataset.visibilityStatus === 'public'}"
              ng-disabled="dataset.visibilityStatus === 'public'">Public</button>
          	</div>
	      </div>
			</div>

      <div class="slug" ng-show="dataset._id">
        <h3>Custom URL
          <button
            class="right btn-xs btn-tooltip"
            popover="Create a custom URL for this dataset that is more memorable than a random string of characters. Many people create a URL that matches the dataset title."
            popover-trigger="mouseenter"
            popover-placement="left"
            class="btn btn-default"><i class="fa fa-question"></i>
          </button>
        </h3>
				<span>https://columby.com/d/{{dataset.slug | slugify}}</span>


        <form class="form-horizontal novalidate" role="form" name="slugForm">
          <div class="form-group">
            <input
              name="slug"
              ng-model="dataset.slug"
              class="form-control"
              ng-minlength=3
              ng-maxlength=30/>
            <span class="error" ng-show="slugForm.slug.$error.maxlength">Too long!</span>
            <span class="error" ng-show="slugForm.slug.$error.minlength">Too short!</span>
            <button
              class="btn btn-xs btn-default"
              ng-click="updateSlug()"
              placeholder="dataset-name"
              ng-show="slugForm.$valid">update url</button>
          </div>
        </form>
      </div>

      <!-- <h3>Publication account<button class="right btn-xs btn-tooltip" popover="Select the account you want to publish with." popover-trigger="mouseenter" popover-placement="left" class="btn btn-default">?</button></h3>
      <img src="{{$root.selectedAccount.avatar.url}}"/>
      <a ui-sref="account.view({slug:dataset.account.slug})">{{$root.selectedAccount.name}}</a> -->

    </div>
  </div>

  <div class="content" ng-class="{show:!contentLoading}">

    <div class="header wrapper">
      <div class="container">

        <!-- Editable title -->
        <div class="title" ng-switch="editMode">
          <h1 ng-switch-default ng-bind-html="dataset.title || 'No title yet'"></h1>

          <br><br><br><input ng-switch-when="true"
            type        = "text"
            name        = "title"
            placeholder = "Your title"
            ng-model    = "dataset.titleUpdate"
            ng-blur     = "updateTitle()"
            />
          <h2 class="page-subtitle">dataset</h2>
        </div>

        <!-- Meta -->
        <div class="meta" ng-show="dataset._id">
          <p>A dataset by
            <span class="account"><a ui-sref="account.view({slug:dataset.account.slug})">{{dataset.account.name}}</a>,
            <span class="published">created on <time class="post-date">{{dataset.createdAt | date:'d MMMM yyyy'}}</time></span>
          </p>
        </div>

        <!-- Edit dataset -->
        <div class="actions" ng-show="dataset.canEdit && !editMode">
          <button
            type="button"
            class="btn btn-default btn-xs"
            ng-click="enterEditmode()">edit</button>
        </div>

        <!-- Editable avatar -->
        <div class="avatar">
          <img src="{{$root.selectedAccount.avatar.url}}"/>
        </div>
      </div>
    </div>

    <!-- Dataset Description -->
    <div class="description wrapper">
      <!-- Editable description -->
      <div class="container">
        <div class="col-md-12" ng-switch="editMode">
          <h3 ng-show="editMode">Description<button class="right btn-xs btn-tooltip" popover="----" popover-trigger="mouseenter" popover-placement="left" class="btn btn-default">?</button></h3>
          <div ng-switch-default ng-bind-html="dataset.description || '<p>The publisher of this dataset has not yet provided a description yet.</p>'"></div>
          <div
            ng-switch-when = "true">
            <div
              ng-model = "dataset.description"
              text-angular
              ta-default-wrap='p'
              ta-toolbar = "[['quote','bold','italics','underline'],['ul','ol','indent','outdent'],['insertLink','insertVideo']]"
          ></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Dataset Info -->
    <div class="info wrapper">
      <div class="container">
        <!-- <div class="content" ng-bind-html="summary"></div> -->
        <div class="content"><p>Dit is een voorbeeld van een data licentie regel die automatisch gegenereerd zal worden. Deze dataset heeft <span class="highlight">Licentie X.3.0</span>. De dataset bevat <span class="highlight">3</span> data distributions met in totaal <span class="highlight">351</span> rijen. Er zijn <span class="highlight">2</span> referenties.</p>
          <h3>Columby score<button class="right btn-xs btn-tooltip" popover="The Columby Score meter gauges how specified your publication is. The strength will increase as you fill in the details and add more content." popover-trigger="mouseenter" popover-placement="left" class="btn btn-default">?</button></h3><progressbar class="progress-striped active" max="100" value="55"><i>55%</i></progressbar></div>
      </div>
    </div>

    <!-- Dataset Sources -->
    <div class="distributions wrapper" ng-hide="!dataset._id">
      <div class="container">
        <h3>Data</h3>
        <ul ng-hide="!dataset.distributions || dataset.distributions.length===0">
          <li ng-repeat="distribution in dataset.distributions">
						<h4><a href="{{distribution.accessUrl}}" target="_blank">{{distribution.accessUrl}}</a></h4>
						<div class="date-size">{{distribution.distributionType}} - {{distribution.createdAt}} - {{distribution.size}}</div>
            <div class="actions" ng-show="editMode">
              <a href="" ng-click="editDistribution($index)"><i class="fa fa-edit"></i></a>
              <a href="" ng-click="deleteDistribution($index)"><i class="fa fa-trash"></i></a>
            </div>
					</li>
        </ul>
        <p ng-show="!dataset.distributions || dataset.distributions.length===0">No sources added yet</p>

        <!-- Datasource Modal -->
        <button
          ng-show="editMode"
          class="btn btn-default"
          type="button"
          ng-click="initNewDistribution()"
          >Add new data</button>
      </div>
    </div>

    <!-- Dataset Preview -->
    <div class="preview wrapper" ng-hide="editMode || !dataset.preview">
      <div class="content">
        <table class="table">
          <thead>
            <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
          </thead>
          <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
          <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
          <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
          <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
          <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
        </table>
      </div>
    </div>

    <!-- Dataset Use -->
    <div class="use wrapper" ng-hide="editMode">
      <div class="container">
        <div class="content">
          <h3>Use this dataset</h3>
          <p>Some text about how to use this data.</p>
        </div>
      </div>
    </div>

    <!-- Dataset UUID -->
    <div class="uuid wrapper" ng-show="dataset._id && !editMode">
      <div class="container">
        <div class="content">
          <h4>UUID: {{dataset._id}}</h4>
        </div>
      </div>
    </div>

    <!-- Dataset references -->
    <div class="references wrapper" ng-hide="!dataset._id">
      <div class="container">
        <div class="content">
          <h3>References</h3>
          <ul>
            <li ng-repeat="reference in dataset.references">
							<div class="col-sm-2"><img src="{{reference.image}}" class="img-responsive"/></div>
              <div class="col-sm-10">
                <h4><a href="{{reference.url}}">{{reference.title}}</a></h4>
                <p>{{reference.description}}</p>
							  <p class="meta"><a href="{{reference.url}}">{{reference.provider_display}}</a></p>
              </div>
              <div class="actions" ng-show="editMode">
                <a href="" ng-click="deleteReference($index)"><i class="fa fa-trash"></i></a>
              </div>
						</li>
          </ul>
          <p ng-show="!dataset.references || dataset.references.length===0">No references added yet</p>

        <!-- Datasource Modal -->
        <button
          ng-show="editMode"
          class="btn btn-default"
          type="button"
          ng-click="newReference()"
          >Add new reference</button>
        </div>
      </div>
    </div>

    <!-- Dataset Account -->
    <div class="account wrapper" ng-hide="editMode">
      <div class="container">
        <div class="content">
            <h3>About {{dataset.account.name}}</h3>
            <div ng-bind-html="dataset.account.description"></div>
						<p class="more-about"><a ui-sref="account.view({slug: dataset.account.slug})">more about {{dataset.account.name}}</a></p>
          </div>
        </div>
      </div>
    </div>

    <!-- Dataset Collections -->
    <div class="collections wrapper" ng-hide="dataset || dataset._id || !editMode">
      <div class="container">
        <div class="content">
          <h3>Collections</h3>
          List of collections

          <!-- Datasource Modal -->
          <button
            ng-show="editMode"
            class="btn btn-default"
            type="button"
            ng-click="addToCollection()"
            >Add to collection</button>
        </div>
      </div>
    </div>
  </div>
</div>

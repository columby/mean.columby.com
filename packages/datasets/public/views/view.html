<div class="dataset item edit" ng-controller="DatasetViewCtrl">

  <div class="loader" ng-class="{noshow:!contentLoading}">Loading dataset</div>

  <!-- Editor Sidebar -->
  <div class="editorSidebar" ng-show="editMode">
    <div class="editorSidebarContent">
      <a ng-click="toggleEditMode()">cancel</a>
      <button class="btn dbt-default" ng-show="contentEdited && dataset.publishStatus!=='unpublished'" ng-click="update()">Update</button>
      <button class="btn dbt-default" ng-show="dataset.publishStatus==='unpublished'" ng-click="create()">Create</button>

      <h3>Publication settings</h3>

      <div class="autosave-status">
        <span ng-show="isEmpty(dataset.draft)">No changes. </span>
        <span ng-hide="isEmpty(dataset.draft) || dataset.publishStatus==='unpublished'">{{isEmpty(dataset.draft)}} Your dataset has unpublished changes. </span>
        <span ng-show="autosaveInProgress">Saving...</span>
      </div>

      <h3>Status</h3>
      <strong>{{dataset.publishStatus}}</strong>

      <h3>Publication account</h3>
      <img src="dataset.publisher.avatar"/>
      <a ui-sref="profile({slug:dataset.publisher.slug})">{{dataset.publisher.name}}</a>

    </div>
  </div>

  <div class="dataset-content" ng-class="{show:!contentLoading}">

    <div class="dataset-header-wrapper">
      <div class="dataset-header container">

        <div class="title" ng-switch="editMode">

          <h1 ng-switch-default ng-bind-html="dataset.title || 'no title yet'"></h1>
          <h1 ng-switch-when="true"
            contenteditable
            name="title"
            ng-model="dataset.title"
            htmlFormat="plain">
          </h1>

        </div>

        <div class="avatar">
          <img src="{{dataset.publisher.avatar.url}}"/>
        </div>
      </div>
    </div>

    <div class="dataset-description-wrapper">

      <div class="dataset-description container">
        <div class="col-md-12" ng-switch="editMode">
          <div ng-switch-default ng-bind-html="dataset.description || 'The publisher of this dataset has not yet provided a description yet.'"></div>
          <div ng-switch-when="true"
            ng-model="dataset.description"
            text-angular
            placeholder="please enter your description"
            ta-toolbar="[['quote','bold','italics','underline'],['ul','ol','indent','outdent'],['insertLink','insertVideo']]"
          ></div>
        </div>
      </div>
    </div>

    <div class="dataset-info-wrapper" ng-hide="editMode">
      <div class="container">
        <div class="dataset-info">
          <div class="dataset-info-content" ng-bind-html="summary"></div>
        </div>
      </div>
    </div>

    <div class="dataset-sources-wrapper" ng-hide="dataset.publishStatus==='unpublished'">
      <div class="dataset-sources container">
        <h3>Sources</h3>
        <ul>
          <li ng-repeat="source in dataset.sources">
						<h4><a href="#">{{source.title}}</a></h4>
						<div class="date-size">{{source.createdAt}} - {{source.size}}</div>
					</li>
        </ul>
        <p ng-show="!dataset.sources || dataset.sources.length===0">No sources added yet</p>
      </div>
    </div>

    <div class="dataset-preview-wrapper" ng-hide="editMode || !dataset.preview">
      <div class="content">
        <table class="table">
          <thead>
            <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
          </thead>
          <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
          <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
          <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
          <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
          <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
        </table>
      </div>
    </div>

    <div class="dataset-use-wrapper" ng-hide="editMode">
      <div class="container">
        <div class="content">
          <h3>Use this dataset</h3>
          <p>Some text about how to use this data.</p>
        </div>
      </div>
    </div>

    <div class="dataset-id-wrapper" ng-show="dataset._id && !editMode">
      <div class="container">
        <div class="dataset-id content">
          <h4>UUID: {{dataset._id}}</h4>
        </div>
      </div>
    </div>

    <div class="dataset-references-wrapper" ng-show="dataset.references">
      <div class="container">
        <div class="dataset-references content">
          <h3>References</h3>
          <ul>
            <li ng-repeat="reference in dataset.references">
							<h4><a href="#">{{reference.title}}</a></h4>
							<div class="date-url">{{reference.date}} - <a href="#">{{reference.url}}</a></div>
						</li>
          </ul>
          <p ng-show="!dataset.references || dataset.references.length===0">No references added yet</p>
        </div>
      </div>
    </div>

    <div class="dataset-publisher-wrapper" ng-hide="editMode">
      <div class="container">
        <div class="dataset-publisher-content">
            <h3>About the publisher: <a ui-sref="profile({slug: dataset.publisher.slug})">{{dataset.publisher.name}}</a></h3>
            <div ng-bind-html="dataset.publisher.description"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
